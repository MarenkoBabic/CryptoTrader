<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - Meine ASP.NET-Anwendung</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryui")
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/toastr")
    <link href="~/Content/Custom/DashBoard.css" rel="stylesheet" />
</head>
<body>
    <div id="wrapper">

        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">

            <!-- Überschrift -->
            <div class="navbar-header">
                @Html.ActionLink(" CryptoCoinCompany ", "Index", "Home", new { area = "" }, new { @class = "navbar-brand" })
            </div>

            <!--Benutzer-->
            <ul class="nav navbar-right top-nav">
                <li>@Html.ActionLink("Regestrieren", "nix", "nix", new { data_toggle = "modal", data_target = "#RegisterDialog" })</li>
                <li>@Html.ActionLink("Login", "nix", "nix", new { data_toggle = "modal", data_target = "#Login" })</li>
            </ul>

            <!-- Sidebar Menu Items-->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav side-nav">

                    <!--BitCoin Kurs-->
                    <li>
                        <a>
                            <i class="glyphicon glyphicon-bitcoin"></i>
                            <span class="my-span">BitCoin</span>

                        </a>
                        <ul id="MoneyTransfer">
                            <li><a>1 Bitcoin =<span id="rate" class="glyphicon glyphicon-euro"></span></a></li>

                        </ul>
                    </li>

                    <!--User Verifiziren-->
                    <li>
                        <a>
                            <i class="glyphicon glyphicon-user"></i>
                            <span class="my-span">Verifiziren</span>
                        </a>
                        <ul id="MoneyTransfer">
                            <li>@Html.ActionLink("Verifiziren", "PersonVerification", "Register")</li>
                        </ul>
                    </li>
                    
                    <!--Money Transfer-->
                    <li>
                        <a>
                            <i class="glyphicon glyphicon-euro"></i>
                            <span class="my-span">Geld Transfer</span>
                        </a>
                        <ul id="MoneyTransfer">
                            <li>@Html.ActionLink("Geld einzahlen", "PayIn", "BankTransfer")</li>
                            <li>@Html.ActionLink("Geld auszahlen", "PayOut", "BankTransfer")</li>
                        </ul>
                    </li>

                    <!--Trade-->
                    <li>
                        <a>
                            <i class="glyphicon glyphicon-euro"></i>
                            <span class="my-span">Handeln</span>
                        </a>
                        <ul id="TradeBitCoin">
                            <li>@Html.ActionLink("Bitcoin kaufen", "BuyBitcoin", "Trade")</li>
                            <li>@Html.ActionLink("Bitcoin verkaufen", "SellBitCoin", "Trade")</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <!-- /.navbar-collapse -->
        </nav>

    </div><!-- /#wrapper -->
    @Html.Partial("~/Views/Shared/_LoginDialog.cshtml")
    @Html.Partial("~/Views/Shared/_RegisterDialog.cshtml")
    @RenderBody()


    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
</body>
</html>
<script type="text/javascript">
        toastr.options = {
            "closeButton": true,
            "debug": false,
            "positionClass": "toast-top-right",
            "onclick": null,
            "showDuration": "300",
            "hideDuration": "1000",
            "timeOut": "3000",
            "extendedTimeOut": "1000",
            "showEasing": "swing",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        }
        $(document).ready(function () {

            @if (TempData["ErrorMessage"] != null)
            {
                <text>
            toastr.error("", "@TempData["ErrorMessage"]");
            </text>
            }

            @if (TempData["OkMessage"] != null)
            {
                <text>
            toastr.success("", "@TempData["OkMessage"]");
            </text>
            }

    });

    $(document).ready(function () {
        GetRate();
    });

    function GetRate() {
        $.ajax({ url: "/Ticker/ShowRate" })
            .done(function (response) {
                console.log("GetRate")
                var result = "";
                var rate_old = ($("#rate").html());
                var rate_current = (response);

                $("#rate").html(rate_current);

                if (rate_current > rate_old) {
                    result = ($(".rate").val());
                    $(".rate").css("color", "green");
                    $("#rate").css("color", "green");
                }
                else if (rate_current < rate_old) {
                    result = ($(".rate").html());
                    $(".rate").css("color", "red");
                    $("#rate").css("color", "red");
                }
                else if (rate_current == rate_old) {
                    result = ($(".rate").html());
                    $(".rate").css("color", "goldenrod");
                    $("#rate").css("color", "goldenrod");
                }

                setTimeout(function () { GetRate(); }, 2000);
            });
    }

</script>
